#!/usr/bin/env python3

"""
Migration script to add Bulgarian translations of existing blog posts.
This script creates Bulgarian versions of all English blog posts with proper translation_id linking.
"""

import os
import sys
from datetime import datetime
from database import SessionLocal, engine
from models import BlogPost, Base
import uuid

# Bulgarian translations of existing blog posts
BULGARIAN_BLOG_POSTS = [
    {
        "slug": "ovladyavane-na-publichnoto-govorene",
        "title": "Овладяване на публичното говорене: 5 театрални техники, които работят",
        "excerpt": "Научете как театралните техники могат да трансформират уменията ви за публично говорене и да ви помогнат да се свържете с всяка публика.",
        "content": """
        <p>Публичното говорене често се цитира като една от най-разпространените страхове, които хората имат. Въпреки това, с правилните техники всеки може да стане уверен и ангажиращ говорител. Като актьор и коуч с над 20 години опит, открих, че театралните техники предлагат мощни инструменти за подобряване на уменията за публично говорене.</p>
        
        <h2>1. Силата на контрола на дишането</h2>
        <p>Актьорите разбират, че дишането е основата на гласовата проекция и емоционалния контрол. Преди да излезете на сцената, практикувайте дълбоко диафрагмално дишане: вдишвайте бавно през носа за четири броя, задръжте за два, и издишвайте през устата за шест. Тази техника успокоява нервите и осигурява необходимата дихателна подкрепа за ясна, силна реч.</p>
        
        <h2>2. Физическо заземяване</h2>
        <p>Театралните изпълнители знаят, че позата и стойката влияят както на това как се чувствате, така и на това как другите ви възприемат. Застанете с краката на ширината на раменете, равномерно разпределете тежестта. Почувствайте връзката си със земята. Тази "силна позиция" увеличава увереността и проектира авторитет пред публиката ви.</p>
        
        <h2>3. Гласово разнообразие</h2>
        <p>Монотонното произнасяне бързо ще загуби публиката ви. Практикувайте промяна на височината, темпото и силата на гласа. Опитайте да прочетете едното и също изречение като въпрос, възбудено твърдение и тържествена декларация. Тази гъвкавост прави речта ви по-ангажираща и помага да подчертаете ключовите точки.</p>
        
        <h2>4. Паузата</h2>
        <p>Един от най-мощните инструменти в театъра е стратегическата пауза. Много говорители бързат през материала си, но добре поставените паузи дават на публиката време да усвои важните точки и създават драматично подчертаване. Не се страхувайте от тишината - тя често е по-мощна от думите.</p>
        
        <h2>5. Работа с характер</h2>
        <p>Когато сте нервни, опитайте да мислите за презентацията си като за представление. Създайте леко по-уверена "героична" версия на себе си. Тази ментална промяна може да помогне да разделите личната тревожност от задачата, позволявайки ви да представите с по-голяма лекота.</p>
        
        <p>Тези базирани на театър техники са помогнали на безброй професионалисти да трансформират способностите си за публично говорене. Помнете, че като всяко умение, подобрението идва с практика. Започнете да включвате тези подходи в презентациите си и скоро ще се окажете говорещ с по-голяма увереност и въздействие.</p>
        """,
        "tags": ["публично-говорене", "театър"],
        "language": "bg",
        "is_published": True,
        "published_at": datetime(2023, 5, 15),
        "translation_id": "public-speaking-guide"
    },
    {
        "slug": "saveti-za-glas-proektsiya",
        "title": "Съвети за гласова проекция за ефективна комуникация",
        "excerpt": "Открийте как да използвате гласа си ефективно, за да привлечете внимание и да предадете послението си с въздействие.",
        "content": """
        <p>Гласът ви е един от най-мощните инструменти за комуникация. Независимо дали говорите пред малка grupa или се обръщате към голяма аудитория, начинът, по който използвате гласа си, може да направи разликата между ангажиране на слушателите и загубване на вниманието им.</p>
        
        <h2>Разбиране на гласовата проекция</h2>
        <p>Гласовата проекция не е кресчане - тя е създаването на ясен, резонантен звук, който се носи добре. Включва правилна дихателна подкрепа, гласово поставяне и артикулация.</p>
        
        <h2>Дихателна подкрепа: основата</h2>
        <p>Всяка добра гласова работа започва с правилно дишане. Практикувайте диафрагмално дишане, като поставите ръката на корема си и се уверите, че се разширява, когато вдишвате. Това осигурява необходимата въздушна подкрепа за силна проекция.</p>
        
        <h2>Намиране на резонанс</h2>
        <p>За да добавите богатство към гласа си, се съсредоточете върху създаването на резонанс в гърдите, гърлото и лицевите кухини. Опитайте да мърморите на различни височини, за да почувствате къде гласът ви резонира най-естествено.</p>
        
        <h2>Упражнения за артикулация</h2>
        <p>Ясната артикулация гарантира, че думите ви са разбрани. Практикувайте скоропоговорки всеки ден, за да подобрите прецизността на съгласните и яснотата на гласните.</p>
        
        <h2>Разнообразяване на доставката</h2>
        <p>Динамичният глас поддържа слушателите ангажирани. Експериментирайте с промяна на темпото, височината и силата на гласа, за да подчертаете важните точки и да създадете интерес.</p>
        
        <h2>Практически съвети за ежедневна практика</h2>
        <p>Отделяйте 10 минути всеки ден за гласови упражнения. Записвайте се как говорите и слушайте критично. Практикувайте проектирането към задната част на стаята, без да натоварвате гласа си.</p>
        
        <p>Помнете, добре проектираният глас комуникира увереност и авторитет. С последователна практика на тези техники ще развиете глас, който привлича внимание и ефективно предава послението ви.</p>
        """,
        "tags": ["глас", "комуникация"],
        "language": "bg",
        "is_published": True,
        "published_at": datetime(2023, 4, 22),
        "translation_id": "voice-projection-guide"
    },
    {
        "slug": "sekretite-na-ezika-na-tyaloto",
        "title": "Секретите на езика на тялото от професионални актьори",
        "excerpt": "Изследвайте как професионалните актьори използват езика на тялото, за да подобрят представянията си и как можете да приложите тези техники.",
        "content": """
        <p>Езикът на тялото е мощна форма на комуникация, която може значително да повлияе на това как другите ви възприемат и отговарят. Професионалните актьори прекарват години в усвояване на изкуството на физическата експресия, и техните техники могат да бъдат невероятно ценни за всеки, който иска да подобри комуникационните си умения.</p>
        
        <h2>Основата: поза и подравняване</h2>
        <p>Актьорите знаят, че всичко започва с правилната поза. Застанете изправени с раменете назад, но не rigid. Представете си струна, която ви изтегля нагоре от върха на главата. Тази подравнена поза не само изглежда уверено, но всъщност ви помага да се чувствате по-уверени.</p>
        
        <h2>Огледалност и съвпадение</h2>
        <p>Една от най-мощните техники, които актьорите използват, е фината огледалност. Когато леко огледалите позата или жестовете на някого, създавате несъзнателна връзка. Това изгражда взаимопонимание и кара другите да се чувстват по-комфортно с вас.</p>
        
        <h2>Целенасочени жестове</h2>
        <p>Всяко движение, което актьор прави на сцената, има цел. Приложете този принцип към ежедневната си комуникация, като направите жестовете си целенасочени и значими. Избягвайте неспокойни или повтарящи се движения, които могат да отвлекат от послението ви.</p>
        
        <h2>Силата на контакта с очите</h2>
        <p>Актьорите разбират, че очите са прозорци към емоциите. Практикувайте поддържането на подходящ контакт с очите - не втренчване, а ангажиране. Гледайте един човек за пълна мисъл, преди да се преместите към друг.</p>
        
        <h2>Осъзнаване на лицевата експресия</h2>
        <p>Лицето ви комуникира толкова, колкото и думите ви. Практикувайте изразяването на различни емоции с лицевите си експресии. Искрена усмивка, повдигнати вежди за подчертаване или замислена експресия могат да подобрят послението ви.</p>
        
        <h2>Дишане и присъствие</h2>
        <p>Актьорите използват дихателна работа, за да се заземят и да проектират присъствие. Дълбокото, контролирано дишане не само успокоява нервите, но и създава усещане за авторитет и спокойствие, което другите намират привлекателно.</p>
        
        <p>Чрез включването на тези тествани от актьори техники в ежедневните си взаимодействия, ще развиете по-заповедническо присъствие и ще станете по-ефективен комуникатор. Помнете, последователността е ключова - тези умения се подобряват с редовна практика.</p>
        """,
        "tags": ["език-на-тялото", "актьорство"],
        "language": "bg",
        "is_published": True,
        "published_at": datetime(2023, 3, 10),
        "translation_id": "body-language-guide"
    },
    {
        "slug": "preodolyavane-na-strahа-ot-stsena",
        "title": "Преодоляване на страха от сцена: стъпка по стъпка ръководство",
        "excerpt": "Научете практически техники за управление на тревожността и уверено представяне пред всяка публика.",
        "content": """
        <p>Страхът от сцена е обичайно преживяване, което засяга всеки - от опитни изпълнители до говорители за първи път. Ключът към преодоляването му не е в пълното елиминиране на нервите, а в ученето как да ги управлявате и насочвате ефективно.</p>
        
        <h2>Разбиране на страха от сцена</h2>
        <p>Страхът от сцена е естествената реакция на тялото ви към възприемана заплаха. Симпатиковата ви нервна система се активира, заливайки тялото ви с адреналин. Разбирането на тази физиологична реакция е първата стъпка към управлението ѝ.</p>
        
        <h2>Стъпка 1: Подготовката е ключова</h2>
        <p>Колкото по-добре сте подготвени, толкова по-уверени ще се чувствате. Познавайте материала си отвътре и отвън. Практикувайте, докато можете да предадете съдържанието си дори когато сте разсеяни. Тази подготовка става вашата мрежа за безопасност.</p>
        
        <h2>Стъпка 2: Дихателни техники</h2>
        <p>Когато сме тревожни, дишането ни става плитко и бързо. Борете се с това с техниката 4-7-8: вдишайте за 4 броя, задръжте за 7, издишайте за 8. Това активира парасимпатиковата ви нервна система и насърчава спокойствието.</p>
        
        <h2>Стъпка 3: Прогресивна мускулна релаксация</h2>
        <p>Напрежението се натрупва в мускулите ни, когато сме нервни. Практикувайте напрягането и след това отпускането на всяка мускулна група, започвайки от пръстите на краката и работейки нагоре към главата. Това помага за освобождаване на физическото напрежение.</p>
        
        <h2>Стъпка 4: Визуализация</h2>
        <p>Отделете време да визуализирате как успешно изпълнявате представянето си. Вижте се уверени, ангажирани и свързани с публиката си. Тази ментална репетиция помага да програмирате подсъзнанието си за успех.</p>
        
        <h2>Стъпка 5: Преформулирайте мисленето си</h2>
        <p>Вместо да гледате на публиката като на съдии, вижте ги като съюзници, които искат да успеете. Помнете, че те са там да чуят какво имате да кажете, а не да ви критикуват.</p>
        
        <h2>Стъпка 6: Използвайте нервната си енергия</h2>
        <p>Известна нервност всъщност може да подобри представянето, като ви поддържа остри и фокусирани. Насочете тази енергия към ентусиазъм и страст към темата ви.</p>
        
        <p>Помнете, дори опитните изпълнители се вълнуват. Разликата е, че те са научили да работят с нервите си, а не срещу тях. С практика и търпение можете да развиете същата увереност.</p>
        """,
        "tags": ["тревожност", "представяне"],
        "language": "bg",
        "is_published": True,
        "published_at": datetime(2023, 2, 18),
        "translation_id": "stage-fright-guide"
    },
    {
        "slug": "razkazi-za-biznes",
        "title": "Разкази за бизнес: ангажирайте публиката си",
        "excerpt": "Открийте как да използвате техниките на разказването, за да направите бизнес презентациите си по-ангажиращи и запомнящи се.",
        "content": """
        <p>В света на бизнеса фактите и цифрите са важни, но историите са това, което движи хората към действие. Разказването не е само за развлечение - то е мощен инструмент, който може да трансформира бизнес презентациите ви и да ви помогне да се свържете с публиката на по-дълбоко ниво.</p>
        
        <h2>Защо историите работят в бизнеса</h2>
        <p>Историите ангажират множество области на мозъка едновременно. Докато данните активират само центровете за обработка на езика, историите активират сензорната кора, моторната кора и емоционалните центрове. Това прави послението ви по-запомнящо се и убедително.</p>
        
        <h2>Класическата структура на историята</h2>
        <p>Всяка убедителна история следва основна структура: завръзка, конфликт и развръзка. В бизнес контекста това се превръща в: ситуация, предизвикателство и решение. Тази структура поддържа публиката ви ангажирана и прави послението ви ясно.</p>
        
        <h2>Типове бизнес истории</h2>
        <p>Различните типове истории служат на различни цели. Историите за произход изграждат доверие, историите за успех на клиенти предоставят доказателства, а визионерските истории вдъхновяват действие. Изберете правилния тип история за вашата цел.</p>
        
        <h2>Направете историята си релевантна</h2>
        <p>Най-добрите бизнес истории са тези, с които публиката ви може да се свърже. Използвайте герои и ситуации, които отразяват опитите на публиката ви. Това създава емоционална връзка и прави послението ви по-въздействащо.</p>
        
        <h2>Включване на сензорни детайли</h2>
        <p>Не просто казвайте на публиката си какво се е случило - помогнете им да го преживеят. Използвайте сензорни детайли, за да направите историята си ярка. Какво са видели, чули, почувствали хората? Тези детайли правят историите по-ангажиращи и запомнящи се.</p>
        
        <h2>Силата на уязвимостта</h2>
        <p>Споделянето на подходящи предизвикателства и неуспехи ви прави по-свързуеми и заслужаващи доверие. Хората се свързват с човешки истории, които включват както борби, така и триумфи.</p>
        
        <h2>Практика и усъвършенстване</h2>
        <p>Като всяко умение, разказването се подобрява с практика. Започнете като събирате истории от професионалния си опит. Усъвършенствайте ги, практикувайки с колеги и отбелязвайки какво резонира с различни публики.</p>
        
        <p>Помнете, всяка презентация е възможност да разкажете история. Независимо дали презентирате продукт, представяте тримесечни резултати или мотивирате екип, вплитането на наративни елементи в съдържанието ви ще ви направи по-ефективен комуникатор.</p>
        """,
        "tags": ["разказване", "бизнес"],
        "language": "bg",
        "is_published": True,
        "published_at": datetime(2023, 1, 25),
        "translation_id": "storytelling-guide"
    },
    {
        "slug": "dihatelni-tehniki",
        "title": "Дихателни техники за по-добра реч и присъствие",
        "excerpt": "Овладейте изкуството на дишането, за да подобрите гласовото си качество, намалите стреса и засилите цялостното си присъствие.",
        "content": """
        <p>Дишането е основата на всяка гласова работа и лично присъствие. Повечето хора приемат дишането за даденост, но ученето как да дишате правилно може да трансформира гласа ви, да намали тревожността и драматично да подобри ефективността ви в комуникацията.</p>
        
        <h2>Разбиране на правилното дишане</h2>
        <p>Много хора дишат плитко, използвайки само горната част на гърдите. Правилното дишане включва диафрагмата - големия мускул под белите дробове. Това по-дълбоко дишане осигурява по-добра гласова подкрепа и помага да регулирате нервната си система.</p>
        
        <h2>Техниката на диафрагмалното дишане</h2>
        <p>Поставете една ръка на гърдите и една на корема. Когато дишате правилно, долната ръка трябва да се движи повече от горната. Практикувайте това, докато стане естествено.</p>
        
        <h2>Дишане за гласова сила</h2>
        <p>Гласът ви се създава от въздуха, преминаващ през гласовите струни. Колкото по-стабилен и контролиран е въздушният поток, толкова по-добре ще звучи гласът ви. Практикувайте говорене на едно дишане, постепенно увеличавайки дължината на фразите си.</p>
        
        <h2>Дишане за управление на тревожността</h2>
        <p>Когато сме нервни, дишането ни става плитко и бързо. Това всъщност може да увеличи тревожността. Ученето как да контролирате дишането помага да активирате релаксационната реакция на тялото.</p>
        
        <h2>Техниката 4-7-8</h2>
        <p>Тази мощна техника включва вдишване за 4 броя, задържане за 7 и издишване за 8. Особено ефективна е за управление на тревожността от представяне и може да се прави навсякъде.</p>
        
        <h2>Квадратно дишане</h2>
        <p>Използвано от военни професионалисти и атлети, квадратното дишане включва еднакви броене за вдишване, задържане, издишване и отново задържане. Започнете с 4 броя за всяка фаза и постепенно увеличавайте.</p>
        
        <h2>Дихателни упражнения за ежедневна практика</h2>
        <p>Отделяйте 5-10 минути всеки ден за дихателни упражнения. Това може да се прави докато пътувате, преди важни срещи или като част от сутрешната ви рутина. Последователността е по-важна от продължителността.</p>
        
        <h2>Дишане и присъствие</h2>
        <p>Правилното дишане не само подобрява гласа ви - то засилва цялостното ви присъствие. Когато дишате дълбоко и спокойно, изглеждате по-уверени и центрирани, което влияе на това как другите ви възприемат и отговарят.</p>
        
        <p>Помнете, дишането е едновременно автоматично и контролируемо. Като поемете съзнателен контрол над дишането си, можете да подобрите гласа си, да управлявате стреса и да проектирате по-голяма увереност във всичките си взаимодействия.</p>
        """,
        "tags": ["дишане", "глас"],
        "language": "bg",
        "is_published": True,
        "published_at": datetime(2022, 12, 12),
        "translation_id": "breathing-guide"
    }
]

def migrate_bulgarian_blog_posts():
    """Add Bulgarian translations of existing blog posts"""
    
    # Create tables if they don't exist
    Base.metadata.create_all(bind=engine)
    
    # Create database session
    db = SessionLocal()
    
    try:
        # First, update existing English posts with translation_id
        print("Updating existing English posts with translation_id...")
        
        translation_mappings = {
            "mastering-public-speaking": "public-speaking-guide",
            "voice-projection-tips": "voice-projection-guide", 
            "body-language-secrets": "body-language-guide",
            "overcoming-stage-fright": "stage-fright-guide",
            "storytelling-for-business": "storytelling-guide",
            "breathing-techniques": "breathing-guide"
        }
        
        for english_slug, translation_id in translation_mappings.items():
            english_post = db.query(BlogPost).filter(
                BlogPost.slug == english_slug,
                BlogPost.language == "en"
            ).first()
            
            if english_post:
                english_post.translation_id = translation_id
                print(f"  Updated {english_slug} with translation_id: {translation_id}")
        
        # Check if Bulgarian posts already exist
        existing_bg_posts = db.query(BlogPost).filter(BlogPost.language == "bg").count()
        if existing_bg_posts > 0:
            print(f"Database already contains {existing_bg_posts} Bulgarian blog posts.")
            print("Deleting existing Bulgarian posts and re-importing...")
            
            # Delete existing Bulgarian posts
            db.query(BlogPost).filter(BlogPost.language == "bg").delete()
            print("Existing Bulgarian blog posts deleted.")
        
        # Insert new Bulgarian blog posts
        print("Inserting Bulgarian blog posts...")
        for post_data in BULGARIAN_BLOG_POSTS:
            blog_post = BlogPost(**post_data)
            db.add(blog_post)
            print(f"  Added Bulgarian post: {post_data['title']}")
        
        db.commit()
        print(f"Successfully migrated {len(BULGARIAN_BLOG_POSTS)} Bulgarian blog posts to the database.")
        
        # Verify the migration
        total_posts = db.query(BlogPost).count()
        en_posts = db.query(BlogPost).filter(BlogPost.language == "en").count()
        bg_posts = db.query(BlogPost).filter(BlogPost.language == "bg").count()
        
        print(f"Total blog posts in database: {total_posts}")
        print(f"English posts: {en_posts}")
        print(f"Bulgarian posts: {bg_posts}")
        
    except Exception as e:
        db.rollback()
        print(f"Error during migration: {e}")
        raise
    finally:
        db.close()

if __name__ == "__main__":
    print("Starting Bulgarian blog post migration...")
    migrate_bulgarian_blog_posts()
    print("Migration completed successfully!")